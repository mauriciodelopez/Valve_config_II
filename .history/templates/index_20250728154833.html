<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valve Configurator</title>
    <!-- Bootstrap CSS CDN for styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS file -->
    <link rel="stylesheet" href="/static/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Three.js CDN for 3D rendering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- OrbitControls for interactive camera movement -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <!-- Font Awesome for info icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="bg-light d-flex align-items-center justify-content-center min-vh-100 py-4">
    <div class="container my-4 p-0 shadow rounded-3">
        <div class="row g-0"> <!-- Use Bootstrap row for horizontal alignment on larger screens -->

            <!-- Form Column -->
            <div class="col-12 col-lg-6"> <!-- Takes full width on small, half on large screens -->
                <div class="bg-primary text-white p-4 rounded-top-3 rounded-lg-end-0">
                    <!-- Image added here with a new class for animation -->
                    <div class="text-center mb-3">
                        <img src="/static/logo planta web configurateur.jpg" alt="Company Logo" class="img-fluid logo-animated">
                    </div>
                    <h1 class="text-center mb-2 fs-2 fw-bold">Valve Configurator</h1>
                    <p class="text-center mb-0 fs-6">
                        Answer the questions below to find the ideal valve from the Tecofi Technical Guide.
                    </p>
                </div>

                <form id="valveConfiguratorForm" class="p-4 p-md-5 needs-validation" novalidate>
                    <!-- Section 1: Main Function -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">1. Main Function</h2>
                        <div class="mb-3">
                            <label for="mainFunction" class="form-label mb-2">What is the primary function of the valve?</label>
                            <select id="mainFunction" name="mainFunction" class="form-select" required>
                                <option value="">Select a function</option>
                                <option value="on_off">On/Off (Sectionner un écoulement)</option>
                                <option value="regulation">Regulation (Assurer un réglage)</option>
                                <option value="on_off_regulation">On/Off & Regulation (Sectionner un écoulement et assurer un réglage)</option>
                            </select>
                            <div class="invalid-feedback">
                                Please select a main function.
                            </div>
                        </div>
                    </div>

                    <!-- Section 2: Material (Body & Bonnet) -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">2. Body & Bonnet Material</h2>
                        <div class="mb-3">
                            <label for="bodyBonnetMaterial" class="form-label mb-2">What material is required for the body and bonnet?</label>
                            <select id="bodyBonnetMaterial" name="bodyBonnetMaterial" class="form-select" required>
                                <option value="">Select a material</option>
                                <option value="cast_iron">Cast Iron (Fonte Grise)</option>
                                <option value="ductile_iron">Ductile Iron (Fonte GS)</option>
                                <option value="carbon_steel">Carbon Steel (Acier au Carbone)</option>
                                <option value="stainless_steel">Stainless Steel (Inox 304-316)</option>
                                <option value="stainless_steel_310">Stainless Steel (Inox 310)</option>
                                <option value="brass">Brass (Laiton)</option>
                                <option value="bronze">Bronze</option>
                                <option value="duplex_super_duplex">Duplex / Super Duplex</option>
                                <option value="plastic">Plastic (PVC, PP)</option>
                            </select>
                            <div class="invalid-feedback">
                                Please select a body and bonnet material.
                            </div>
                        </div>
                    </div>

                    <!-- Section 3: Operating Conditions -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">3. Operating Conditions</h2>
                        <div class="row g-3 mb-3">
                            <div class="col-md-6">
                                <label for="temperature" class="form-label mb-2">Maximum Operating Temperature (°C):</label>
                                <input type="number" id="temperature" name="temperature" min="-200" max="850" placeholder="e.g., 180" class="form-control" required>
                                <div class="invalid-feedback">
                                    Please enter a valid temperature.
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label for="pressure" class="form-label mb-2">Maximum Operating Pressure (bar):</label>
                                <input type="number" id="pressure" name="pressure" min="0" max="400" placeholder="e.g., 10" class="form-control" required>
                                <div class="invalid-feedback">
                                    Please enter a valid pressure.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Section 4: Seal Surface Material -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">4. Seal Surface Material</h2>
                        <div class="mb-3">
                            <label for="sealSurfaceMaterial" class="form-label mb-2">What material is preferred for the seal surface?</label>
                            <select id="sealSurfaceMaterial" name="sealSurfaceMaterial" class="form-select">
                                <option value="">Select a material (Optional)</option>
                                <option value="elastomer">Elastomer</option>
                                <option value="ptfe">PTFE (Teflon®)</option>
                                <option value="rubber_seal">Rubber Seal (Membrane Caoutchouc)</option>
                                <option value="copper_alloys">Copper Alloys (Laiton-Bronze)</option>
                                <option value="stainless_steel_seal">Stainless Steel (Acier Inox)</option>
                                <option value="stellite">Stellite</option>
                            </select>
                        </div>
                    </div>

                    <!-- Section 5: Connection Type -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">5. Connection Type</h2>
                        <div class="mb-3">
                            <label for="connectionType" class="form-label mb-2">What type of connection is needed?</label>
                            <select id="connectionType" name="connectionType" class="form-select">
                                <option value="">Select a connection type (Optional)</option>
                                <option value="threaded">Threaded (Taraudé)</option>
                                <option value="flanged">Flanged (À bride)</option>
                                <option value="socket_welding">Socket Welding (Soudage emboitement)</option>
                                <option value="butt_welding">Butt Welding (Soudage bout à bout)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Section 6: Nominal Diameter -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">6. Nominal Diameter</h2>
                        <div class="mb-3">
                            <label for="nominalDiameter" class="form-label mb-2">Nominal Diameter (DN in mm or inches for threaded):</label>
                            <input type="text" id="nominalDiameter" name="nominalDiameter" placeholder="e.g., 100 (mm) or 4 (inches)" class="form-control">
                            <div class="form-text text-muted mt-1">Specify unit (mm or inches) if applicable.</div>
                        </div>
                    </div>

                    <!-- Section 7: Fluid Type & Lubricant -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">7. Media Data / Fluid Type</h2>
                        <div class="mb-3">
                            <label for="mediaData" class="form-label mb-2">What type of fluid will the valve handle?</label>
                            <select id="mediaData" name="mediaData" class="form-select">
                                <option value="">Select a fluid type</option>
                                <option value="liquid">Liquid</option>
                                <option value="gas">Gas</option>
                                <option value="gaseous">Gaseous</option>
                                <option value="drinking water">Drinking Water</option>
                                <option value="steam">Steam</option>
                                <option value="abrasive products">Abrasive Products (e.g., Slurries, Pulp)</option>
                                <option value="corrosive fluid">Corrosive Fluid (e.g., Acids, Bases)</option>
                                <option value="cryogenic fluid">Cryogenic Fluid</option>
                                <option value="sea water">Sea Water</option>
                                <option value="ammonia">Ammonia</option>
                                <option value="nuclear">Nuclear (e.g., heavy water, radioactive fluids)</option>
                                <option value="oil">Oil</option>
                                <option value="other">Other / Not listed</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="lubricantType" class="form-label mb-2">Is the fluid with or without lubricant?</label>
                            <select id="lubricantType" name="lubricantType" class="form-select">
                                <option value="">Select lubricant type</option>
                                <option value="with lubricant">With Lubricant</option>
                                <option value="without lubricant">Without Lubricant</option>
                                <option value="other lubricant">Others</option>
                            </select>
                        </div>
                    </div>

                    <!-- Section 8: Actuation Type -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">8. Actuation Type</h2>
                        <div class="mb-3">
                            <label for="actuationType" class="form-label mb-2">What type of actuation is required?</label>
                            <select id="actuationType" name="actuationType" class="form-select" required>
                                <option value="">Select actuation type</option>
                                <option value="manual">Manual</option>
                                <option value="electric">Electric</option>
                                <option value="pneumatic">Pneumatic</option>
                            </select>
                            <div class="invalid-feedback">
                                Please select an actuation type.
                            </div>
                        </div>
                    </div>

                    <!-- Section 9: Safety Factor -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">
                            9. Safety Factor
                            <i class="fas fa-info-circle text-info ms-2" id="safetyFactorInfoIcon" style="cursor: pointer;"></i>
                        </h2>
                        <div id="safetyFactorInfoText" class="alert alert-info mt-3 d-none">
                            Each shut-off valve has a specific breakaway torque without load for opening and closing this valve. This depends on the technical characteristics of the valve (nominal size, seal, design, etc.) and is usually specified by the manufacturer.
                            This torque must be overcome with the aid of an electric or pneumatic actuator in order to move the valve to its respective end positions.
                            Depending on the application and operating conditions, the specific torque may increase under load. The medium and pressure as well as the downtime of the valve have an influence.
                            To ensure safe opening and closing of a valve under load, the specific valve torque should not only be overcome minimally, but exceeded by a defined factor. In actuator technology, the design therefore takes the so-called safety factor into account. For applications with adhesive, non-lubricating media, higher operating pressures or long service lives, a higher safety factor should be used. Non-adhesive, lubricating media, low pressures and/or high switching frequencies require correspondingly smaller safety factors.
                            For pneumatic actuators, it should also be noted: A higher safety factor accelerates the closing and opening of the valve.
                        </div>
                        <div class="mb-3">
                            <label for="safetyFactor" class="form-label mb-2">Enter Safety Factor (e.g., 1.3 for standard, 1.5 for high):</label>
                            <input type="number" id="safetyFactor" name="safetyFactor" step="0.1" min="1.0" max="5.0" placeholder="e.g., 1.3" class="form-control">
                            <div class="form-text text-muted mt-1">Typically a value like 1.3, 1.5, or higher for demanding applications.</div>
                        </div>
                    </div>

                    <!-- Section 10: Differential Pressure -->
                    <div class="mb-4 pb-3 border-bottom">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">
                            10. Differential Pressure
                            <i class="fas fa-info-circle text-info ms-2" id="differentialPressureInfoIcon" style="cursor: pointer;"></i>
                        </h2>
                        <div id="differentialPressureInfoText" class="alert alert-info mt-3 d-none">
                            Without input, the differential pressure automatically corresponds to the operating pressure.
                            The differential pressure is the result of the inlet pressure upstream of the valve minus the outlet pressure downstream of the valve.
                            If the valve is shut off against free outlet, a differential pressure equal to the operating pressure results. This means that the shut-off element in the valve (ball/disc) is pressed into its seat by the force of the full operating pressure.
                            Counter pressures (and thus smaller differential pressures) can ensure that the friction in the shut-off element of the valve is lower and thus a lower torque is required and thus have an influence on the actuator design.
                        </div>
                        <div class="mb-3">
                            <label for="differentialPressure" class="form-label mb-2">Enter Differential Pressure (bar):</label>
                            <input type="number" id="differentialPressure" name="differentialPressure" min="0" max="400" placeholder="e.g., 5" class="form-control">
                            <div class="form-text text-muted mt-1">Leave blank if it corresponds to the operating pressure.</div>
                        </div>
                    </div>

                    <!-- Section 11: Approvals -->
                    <div class="mb-4 pb-3">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">11. Approvals</h2>
                        <div class="mb-3">
                            <label for="approvals" class="form-label mb-2">Select required approvals:</label>
                            <select id="approvals" name="approvals" class="form-select">
                                <option value="">Select an approval (Optional)</option>
                                <option value="dvgw_gas">DVGW Gas</option>
                                <option value="dvgw_drinking_water">DVGW Drinking Water</option>
                                <option value="fda">FDA</option>
                                <option value="ce">CE Marking</option>
                                <option value="atex">ATEX</option>
                                <option value="sil">SIL</option>
                                <option value="fire_safe">Fire Safe</option>
                                <option value="other_approvals">Other Approvals</option>
                            </select>
                        </div>
                    </div>

                    <!-- Section 12: Additional Requirements (AI Prompt) -->
                    <div class="mb-4 pb-3">
                        <h2 class="fs-5 fw-semibold text-secondary mb-3">12. Additional Requirements (AI Prompt)</h2>
                        <div class="mb-3">
                            <label for="aiPrompt" class="form-label mb-2">Describe any other specific needs or context for the valve (e.g., "I need a valve for a water treatment plant..."):</label>
                            <textarea id="aiPrompt" name="aiPrompt" class="form-control" rows="4" placeholder="e.g., 'This valve is for a highly corrosive chemical, needs to be fail-safe closed.'"></textarea>
                            <div class="form-text text-muted mt-1">This information will be used by the AI to refine recommendations.</div>
                        </div>
                    </div>

                    <div class="d-grid mt-4">
                        <button type="submit" class="btn btn-primary btn-lg">
                            Find Recommended Valves
                        </button>
                    </div>
                </form>

                <div id="results" class="p-4 p-md-5 bg-light rounded-bottom-3 shadow-sm d-none">
                    <h2 class="fs-5 fw-semibold text-secondary mb-3">Recommended Valve Types:</h2>
                    <ul id="valveList" class="list-unstyled text-dark">
                        <!-- Results will be dynamically inserted here -->
                    </ul>
                    <p id="noResultsMessage" class="text-muted fst-italic d-none">No specific recommendations found based on your criteria. Please adjust your selections or contact Tecofi directly.</p>
                </div>
            </div>

            <!-- 3D Viewer Column -->
            <div class="col-12 col-lg-6 d-flex align-items-center justify-content-center p-4 p-md-5">
                <div id="container3D" class="bg-light d-flex align-items-center justify-content-center text-muted fs-5 rounded shadow-sm w-100" style="min-height: 300px; height: 50vh; max-height: 600px; border: 1px solid #dee2e6;">
                    Select valve options to visualize the 3D model.
                </div>
            </div>

        </div> <!-- End of row -->
    </div> <!-- End of container -->

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Link to the external JavaScript file -->
    <script src="/static/script.js"></script>
</body>
</html>
